<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
          "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets">

<h:body>

	<ui:composition xmlns="http://www.w3.org/1999/xhtml"
		xmlns:h="http://java.sun.com/jsf/html"
		xmlns:f="http://java.sun.com/jsf/core"
		xmlns:c="http://java.sun.com/jsp/jstl/core"
		xmlns:p="http://primefaces.org/ui">
		
		<style>
			.ui-organigram .ui-organigram-node.compoundGroup {
				background: #93e7ff;
				background: -moz-linear-gradient(top, #93e7ff 0%, #007efc 100%);
				background: -webkit-linear-gradient(top, #93e7ff 0%, #007efc 100%);
				background: linear-gradient(to bottom, #93e7ff 0%, #007efc 100%);
			}
			
			.ui-organigram .ui-organigram-node.compound {
				background: #88c048;
				background: -moz-linear-gradient(top, #88c048 0%, #69a038 100%);
				background: -webkit-linear-gradient(top, #88c048 0%, #69a038 100%);
				background: linear-gradient(to bottom, #88c048 0%, #69a038 100%);
			}
		</style>

		<h:panelGroup id="resultClusterPanel" layout="block">
			<h:panelGroup rendered="#{metFragWebBean.compoundsClusterReady}">
				
				<p:growl id="resultsClusterGrowl" showDetail="true" /> 
				
				<p:organigram id="compoundClusterTree" widgetVar="compoundClusterTree"
					value="#{metFragWebBean.compoundsClusterRoot}" var="node"
					leafNodeConnectorHeight="0"
					autoScrollToSelection="false"
					zoom="true" selection="#{metFragWebBean.selectedNode}">

					<p:ajax event="select" process="@this" listener="#{metFragWebBean.nodeSelectListener}" />
					<p:ajax event="contextmenu" process="@this" />
					
					<p:organigramNode type="compoundGroup" styleClass="compoundGroup">
						<h:outputText value="#{node.data.maxScore}" />
					</p:organigramNode>

					<p:organigramNode type="compound" styleClass="compound">
						<h:outputText value="#{node.data.name}" />
					</p:organigramNode>
				</p:organigram>

				<p:contextMenu for="compoundClusterTree" nodeType="compoundGroup">
       				<p:menuitem value="Filter selected nodes" 
       					update="mainForm:mainAccordion:MetFragResultsTable
       						mainForm:mainAccordion:peakFilterPanel 
       						mainForm:mainAccordion:scoreDistributionPlot 
       						mainForm:mainAccordion:resultsClusterGrowl"
                    	actionListener="#{metFragWebBean.displaySelectedClusterCompounds}" />
                     <p:menuitem value="Expand complete sub tree" 
                     	ajax="true"
                     	update="compoundClusterTree" 
                    	actionListener="#{metFragWebBean.expandSelectedClusterCompounds}" />	
                    <p:menuitem value="Collapse complete subtree" update="mainForm:mainAccordion:compoundClusterTree"
                    	actionListener="#{metFragWebBean.collapseSelectedClusterCompounds}" />
    			</p:contextMenu>

			</h:panelGroup>
		</h:panelGroup>
		
	</ui:composition>
</h:body>

</html>
